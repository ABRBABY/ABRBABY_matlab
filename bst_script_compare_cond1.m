% Script generated by Brainstorm (09-May-2023)

% Process: Select data files in: */DEV1-STD1/_T8
sFiles = bst_process('CallProcess', 'process_select_files_data', [], [], ...
    'subjectname',   [], ...
    'condition',     'DEV1-STD1', ...
    'tag',           '', ...
    'includebad',    0, ...
    'includeintra',  0, ...
    'includecommon', 0);

sFilesG1 = sFiles(contains({sFiles.FileName},["_T6","_T8","_T10"])); 
sFilesG2 = sFiles(contains({sFiles.FileName},["_T18","_T24"])); 

% Start a new report
bst_report('Start', sFiles);

% % Process: FT t-test unequal cluster [-200ms,500ms EEG]          H0:(A=B), H1:(A<>B)
% sFiles = bst_process('CallProcess', 'process_ft_timelockstatistics', sFiles, sFiles2, ...
%     'sensortypes',    'EEG', ...
%     'timewindow',     [-0.20001, 0.49994], ...
%     'isabs',          0, ...
%     'avgtime',        0, ...
%     'avgchan',        0, ...
%     'randomizations', 1000, ...
%     'statistictype',  1, ...  % Independent t-test
%     'tail',           'two', ...  % Two-tailed
%     'correctiontype', 2, ...  % cluster
%     'minnbchan',      0, ...
%     'clusteralpha',   0.05);
% 
% % Process: Perm t-test equal [0ms,500ms]          H0:(A=B), H1:(A<>B)
% sFiles = bst_process('CallProcess', 'process_test_permutation2', sFiles, sFiles2, ...
%     'timewindow',     [0, 0.49994], ...
%     'sensortypes',    '', ...
%     'isabs',          0, ...
%     'avgtime',        0, ...
%     'avgrow',         0, ...
%     'iszerobad',      1, ...
%     'Comment',        '', ...
%     'test_type',      'ttest_equal', ...  % Student's t-test   (equal variance) t = (mean(A)-mean(B)) / (Sx * sqrt(1/nA + 1/nB))Sx = sqrt(((nA-1)*var(A) + (nB-1)*var(B)) / (nA+nB-2))
%     'randomizations', 1000, ...
%     'tail',           'two');  % Two-tailed

% Process: t-test equal [-200ms,500ms]          H0:(A=B), H1:(A<>B)
sFiles = bst_process('CallProcess', 'process_test_parametric2', sFilesG1, sFilesG2, ...
    'timewindow',    [-0.200012207, 0.4999389648], ...
    'sensortypes',   '', ...
    'isabs',         0, ...
    'avgtime',       0, ...
    'avgrow',        0, ...
    'Comment',       '', ...
    'test_type',     'ttest_equal', ...  % Student's t-test   (equal variance)        A,B~N(m,v)t = (mean(A)-mean(B)) / (Sx * sqrt(1/nA + 1/nB))Sx = sqrt(((nA-1)*var(A) + (nB-1)*var(B)) / (nA+nB-2)) df = nA + nB - 2
    'tail',          'two');  % Two-tailed


% Process: Average: Everything
sFilesAvgG1 = bst_process('CallProcess', 'process_average', sFilesG1, [], ...
    'avgtype',       1, ...  % Everything
    'avg_func',      1, ...  % Arithmetic average:  mean(x)
    'weighted',      0, ...
    'keepevents',    0);

% Process: Add tag: toto
bst_process('CallProcess', 'process_add_tag', sFilesAvgG1, [], ...
    'tag',           'Group1', ...
    'output',        1);  % Add to file name

% Process: Average: Everything
sFilesAvgG2 = bst_process('CallProcess', 'process_average', sFilesG2, [], ...
    'avgtype',       1, ...  % Everything
    'avg_func',      1, ...  % Arithmetic average:  mean(x)
    'weighted',      0, ...
    'keepevents',    0);

% Process: Add tag: Group2
bst_process('CallProcess', 'process_add_tag', sFilesAvgG2, [], ...
    'tag',           'Group2', ...
    'output',        1);  % Add to file name


% Save and display report
ReportFile = bst_report('Save', sFiles);
bst_report('Open', ReportFile);
% bst_report('Export', ReportFile, ExportDir);
% bst_report('Email', ReportFile, username, to, subject, isFullReport);

% Delete temporary files
% gui_brainstorm('EmptyTempFolder');

