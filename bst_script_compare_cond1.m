% Script generated by Brainstorm (09-May-2023)

% Input files
sFiles = {...
    'DVL_003_T10/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_003_T6/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_004_T10/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_004_T18/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_004_T8/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_005_T18/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_006_T10/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_006_T18/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_007_T10/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_007_T18/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_007_T8/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_008_T10/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_008_T18/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_010_T18/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_010_T24/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_011_T10/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_011_T18/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_012_T10/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_012_T18/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_013_T10/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_013_T8/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_014_T24/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_015_T18/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_015_T24/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_016_T18/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_016_T24/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_017_T18/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_018_T10/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_018_T6/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_018_T8/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_019_T24/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_020_T24/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_021_T18/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_022_T18/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_023_T24/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_024_T6/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_026_T18/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_026_T24/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_027_T18/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_028_T24/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_029_T10/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_030_T10/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_031_T18/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_032_T10/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_034_T18/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_036_T18/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_037_T6/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_039_T24/DEV1-STD1/data_230407_1444.mat', ...
    'DVL_040_T18/DEV1-STD1/data_230407_1444.mat'};
sFiles2 = {...
    'DVL_003_T10/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_003_T6/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_004_T10/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_004_T18/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_004_T8/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_005_T18/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_006_T10/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_006_T18/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_007_T10/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_007_T18/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_007_T8/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_008_T10/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_008_T18/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_010_T18/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_010_T24/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_011_T10/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_011_T18/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_012_T10/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_012_T18/DEV1-STD1/data_230407_1442.mat', ...
    'DVL_013_T10/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_013_T8/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_014_T24/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_015_T18/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_015_T24/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_016_T18/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_016_T24/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_017_T18/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_018_T10/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_018_T6/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_018_T8/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_019_T24/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_020_T24/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_021_T18/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_022_T18/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_023_T24/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_024_T6/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_026_T18/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_026_T24/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_027_T18/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_028_T24/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_029_T10/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_030_T10/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_031_T18/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_032_T10/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_034_T18/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_036_T18/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_037_T6/DEV1-STD1/data_230407_1443.mat', ...
    'DVL_039_T24/DEV1-STD1/data_230407_1444.mat', ...
    'DVL_040_T18/DEV1-STD1/data_230407_1444.mat'};

sFiles = sFiles(contains(sFiles,'_T6')|contains(sFiles,'_T8')|contains(sFiles,'_T10')) ; 
sFiles2 = sFiles2(contains(sFiles2,'_T18')|contains(sFiles2,'_T24')) ; 


% Start a new report
bst_report('Start', sFiles);

% % Process: FT t-test unequal cluster [-200ms,500ms EEG]          H0:(A=B), H1:(A<>B)
% sFiles = bst_process('CallProcess', 'process_ft_timelockstatistics', sFiles, sFiles2, ...
%     'sensortypes',    'EEG', ...
%     'timewindow',     [-0.20001, 0.49994], ...
%     'isabs',          0, ...
%     'avgtime',        0, ...
%     'avgchan',        0, ...
%     'randomizations', 1000, ...
%     'statistictype',  1, ...  % Independent t-test
%     'tail',           'two', ...  % Two-tailed
%     'correctiontype', 2, ...  % cluster
%     'minnbchan',      0, ...
%     'clusteralpha',   0.05);
% 
% % Process: Perm t-test equal [0ms,500ms]          H0:(A=B), H1:(A<>B)
% sFiles = bst_process('CallProcess', 'process_test_permutation2', sFiles, sFiles2, ...
%     'timewindow',     [0, 0.49994], ...
%     'sensortypes',    '', ...
%     'isabs',          0, ...
%     'avgtime',        0, ...
%     'avgrow',         0, ...
%     'iszerobad',      1, ...
%     'Comment',        '', ...
%     'test_type',      'ttest_equal', ...  % Student's t-test   (equal variance) t = (mean(A)-mean(B)) / (Sx * sqrt(1/nA + 1/nB))Sx = sqrt(((nA-1)*var(A) + (nB-1)*var(B)) / (nA+nB-2))
%     'randomizations', 1000, ...
%     'tail',           'two');  % Two-tailed

% Process: t-test equal [-200ms,500ms]          H0:(A=B), H1:(A<>B)
sFiles = bst_process('CallProcess', 'process_test_parametric2', sFiles, sFiles2, ...
    'timewindow',    [-0.200012207, 0.4999389648], ...
    'sensortypes',   '', ...
    'isabs',         0, ...
    'avgtime',       0, ...
    'avgrow',        0, ...
    'Comment',       '', ...
    'test_type',     'ttest_equal', ...  % Student's t-test   (equal variance)        A,B~N(m,v)t = (mean(A)-mean(B)) / (Sx * sqrt(1/nA + 1/nB))Sx = sqrt(((nA-1)*var(A) + (nB-1)*var(B)) / (nA+nB-2)) df = nA + nB - 2
    'tail',          'two');  % Two-tailed
% Save and display report
ReportFile = bst_report('Save', sFiles);
bst_report('Open', ReportFile);
% bst_report('Export', ReportFile, ExportDir);
% bst_report('Email', ReportFile, username, to, subject, isFullReport);

% Delete temporary files
% gui_brainstorm('EmptyTempFolder');

